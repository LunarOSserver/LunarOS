div.mod-deploy.deploy-detail
    div.detail-header
        .detail-item
            em.item-name 所在集群
            b.item-content(ng-bind="config.clusterName")
        i.detail-sep
        .detail-item
            em.item-name namespace
            b.item-content(ng-bind="config.namespace")
        i.detail-sep
        .detail-item
            em.item-name 部署类型
            b.item-content(ng-bind="config.deployTypeShow")
        i.detail-sep
        .detail-item
            em.item-name 上次升级时间
            b.item-content(ng-bind="(config.lastUpdateTime | time)")
        i.detail-sep
        .detail-item
            em.item-name 实例个数
            b.item-content(ng-bind="config.currentReplicas")
        i.detail-sep
        .detail-item
            em.item-name 当前版本
            b.item-content(ng-if="!config.currentVersions||config.currentVersions.length===0") 无
            b.item-content(ng-repeat="version in config.currentVersions" ng-cloak) version{{version.version}}
        i.detail-sep
        .detail-item
            em.item-name 状态
            b.item-content(ng-switch="config.deploymentStatus")
                span.txt-success(ng-switch-when="RUNNING") 运行中
                span.txt-error(ng-switch-when="STOP") 停止
                span.txt-primary(ng-switch-when="DEPLOYING") 部署中
                span.txt-warning(ng-switch-when="ERROR") 异常
                //- span.txt-default(ng-switch-when="AB_TEST") 灰度发布
                span.txt-primary(ng-switch-when="STOPPING") 停止中
                span.txt-primary(ng-switch-when="UPDATING") 升级中
                span.txt-primary(ng-switch-when="BACKROLLING") 回滚中
                span.txt-primary(ng-switch-when="UPSCALING") 扩容中
                span.txt-primary(ng-switch-when="DOWNSCALING") 缩容中
                span.txt-warning(ng-switch-when="ABORTING") 中断中
                span.txt-warning(ng-switch-when="BACKROLL_ABORTED") 回滚已中断
                span.txt-warning(ng-switch-when="UPDATE_ABORTED") 升级已中断
        .deploy-option.pull-right.tool-align-input(ng-switch="config.deploymentStatus" ng-if="mayUpdate")
            span(ng-switch-when="RUNNING")
                button.ui-btn.ui-btn-bright.ui-btn-lg(ng-disabled="isWaitingUpVersion" ng-click="operate('update')" ng-if="!config.stateful") 升级/回滚
                button.ui-btn.ui-btn-bright.ui-btn-lg(ng-disabled="isWaitingScale" ng-click="operate('scale')" ng-if="!config.stateful") 扩容/缩容
                button.ui-btn.ui-btn-bright.ui-btn-sm(ng-disabled="isWaitingStop" ng-click="operate('stop')") 停止
            //- button.ui-btn.ui-btn-bright.ui-btn-md(ng-switch-when="AB_TEST" ng-if="!config.stateful") 全部升级
            //- button.ui-btn.ui-btn-bright.ui-btn-md(ng-switch-when="AB_TEST" ng-if="!config.stateful") 全部回滚
            span(ng-switch-when="STOP")
                button.ui-btn.ui-btn-bright.ui-btn-sm(ng-disabled="isWaitingStart" ng-click="operate('start')") 启动
                button.ui-btn.ui-btn-bright.ui-btn-sm(ng-class="{'ui-btn-lg-disabled':!mayDelete}" ng-disabled="!mayDelete" ng-click="deleteDeploy()") 删除
            span(ng-if="config.deploymentStatus=='ERROR'||config.deploymentStatus=='BACKROLL_ABORTED'||config.deploymentStatus=='UPDATE_ABORTED'")
                button.ui-btn.ui-btn-bright.ui-btn-sm(ng-if="!config.stateful" ng-disabled="isWaitingRecover" ng-click="operate('recover')") 恢复
                button.ui-btn.ui-btn-bright.ui-btn-sm(ng-disabled="isWaitingStop" ng-click="operate('stop')") 停止
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="DEPLOYING" ng-disabled="isWaitingOperation" ng-click="operate('abort','DEPLOYING')" ng-if="config.deploymentType !== 'DAEMONSET'") 中断启动
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="UPDATING" ng-disabled="isWaitingOperation" ng-click="operate('abort','UPDATING')" ng-if="config.deploymentType !== 'DAEMONSET'") 中断升级
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="BACKROLLING" ng-disabled="isWaitingOperation" ng-click="operate('abort','BACKROLLING')" ng-if="config.deploymentType !== 'DAEMONSET'") 中断回滚
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="UPSCALING" ng-disabled="isWaitingOperation" ng-click="operate('abort','UPSCALING')" ng-if="config.deploymentType !== 'DAEMONSET'") 中断扩容
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="DOWNSCALING" ng-disabled="isWaitingOperation" ng-click="operate('abort','DOWNSCALING')" ng-if="config.deploymentType !== 'DAEMONSET'") 中断缩容
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="DEPLOYING"  ng-disabled="isWaitingOperation" ng-click="operate('stop')" ng-if="config.deploymentType === 'DAEMONSET'") 停止部署
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="UPDATING" ng-disabled="isWaitingOperation" ng-click="operate('stop')" ng-if="config.deploymentType === 'DAEMONSET'") 停止部署
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="BACKROLLING"  ng-disabled="isWaitingOperation" ng-click="operate('stop')" ng-if="config.deploymentType === 'DAEMONSET'") 停止部署
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="UPSCALING"  ng-disabled="isWaitingOperation" ng-click="operate('stop')" ng-if="config.deploymentType === 'DAEMONSET'") 停止部署
            button.ui-btn.ui-btn-bright.ui-btn-lg(ng-switch-when="DOWNSCALING"  ng-disabled="isWaitingOperation" ng-click="operate('stop')" ng-if="config.deploymentType === 'DAEMONSET'") 停止部署
    loading(ng-if="(tabActive[0].active && isLoadingDetail) || (tabActive[2].active && isLoadingEvent)")
    tabset
        tab(heading="部署详情" active="tabActive[0].active" ui-sref="deployDetail.detail")
            .deploy-info
                .deploy-rollback
                    span.mod-title-name(ng-if="!config.stateful") 部署版本
                    span.mod-title-name(ng-if="config.stateful") 该部署是有状态服务，只有一个部署版本
                    .com-select-con(select-con)
                        button.ui-btn.ui-btn-select.ui-btn-white
                            i.icon-down
                            | {{currentVersionId?'version'+ currentVersionId:'选择版本'}}
                        ul.select-list
                            li.select-item(ng-repeat="version in versionList")
                                a(ng-click="toggleVersion(version.version)" ng-cloak) version{{version.version}}
                    //- button.ui-btn.ui-btn-primary.ui-btn-sm(ng-click="deployVersion()" ng-disabled="waitingForDeploy") 部署该版本
                    span(style="margin-left:15px;" ng-if="mayUpdate")
                        button.ui-btn.ui-btn-bright.ui-btn-sm(ng-if="!deployVersionDraft.deprecate" ng-disabled="isWaitingDeprecate" ng-click="deprecateVersion(currentVersionId)") 废弃
                        span.txt-prompt(ng-if="!deployVersionDraft.deprecate" style="margin-left:15px;") 版本废弃后会解除配置挂载，从而可以删除该配置，废弃的版本不能再运行
                        button.ui-btn.ui-btn-bright.ui-btn-sm(ng-if="deployVersionDraft.deprecate" ng-disabled="isWaitingDeprecate" ng-click="recoverDeprecateVersion(currentVersionId)") 还原
                        span.txt-prompt(ng-if="deployVersionDraft.deprecate" style="margin-left:15px;") 还原废弃版本会检查该版本中挂载的配置是否存在，配置不存在时无法还原
                        a.link-safe(ng-if="storageId" ng-click="goBackStorage()" style="margin-left:15px;") 返回存储
                .com-list-info.mirror-con(ng-repeat="containerDraft in deployVersionDraft.containerConsoles" ng-show="config.versionType === 'CUSTOM'")
                    form
                        form-container
                            form-config-group
                                form-config-item(config-title="镜像名称")
                                    form-input-container
                                        span(ng-bind="containerDraft.name")
                                form-config-item(config-title="镜像仓库")
                                    form-input-container
                                        span(ng-bind="containerDraft.registry")
                                form-config-item(config-title="镜像版本")
                                    form-input-container
                                        span(ng-bind="containerDraft.tag")
                                form-config-item(config-title="自动部署")
                                    form-input-container
                                        span(ng-bind="({true: '已开启', false: '未开启'}[containerDraft.autoDeploy])")
                                form-config-item(config-title="是否已废弃")
                                    form-input-container
                                        span(ng-bind="deployVersionDraft.deprecate?'是':'否'")
                                form-config-item(config-title="存储挂载")
                                    form-input-container
                                        .line-long(ng-if="!containerDraft.volumeMountConsoles || containerDraft.volumeMountConsoles.length === 0") 未设置
                                        .line-long(ng-if="containerDraft.volumeMountConsoles && containerDraft.volumeMountConsoles.length > 0")
                                            table.ui-table-primary.full
                                                thead
                                                    tr
                                                        th 名称
                                                        th 类型
                                                        th 权限
                                                        th 容器内路径
                                                        th 主机内路径
                                                tbody
                                                    tr(ng-repeat="volumeMount in containerDraft.volumeMountConsoles")
                                                        td(ng-bind="volumeMount.name")
                                                        td(ng-bind="({'HOSTPATH': '主机目录', 'EMPTYDIR': '实例内目录'}[volumeMount.volumeType])")
                                                        td(ng-bind="({false:'读写', true:'只读'}[volumeMount.readonly])")
                                                        td(ng-bind="volumeMount.containerPath")
                                                        td(ng-bind="volumeMount.volumeType === 'HOSTPATH'? volumeMount.hostPath : '-'")
                                form-config-item(config-title="配置管理")
                                    form-input-container
                                        .line-long(ng-if="!containerDraft.configConsoles || containerDraft.configConsoles.length === 0") 未设置
                                        .line-long(ng-if="containerDraft.configConsoles && containerDraft.configConsoles.length > 0")
                                            table.ui-table-primary.full
                                                thead
                                                    tr
                                                        th(style="width: 30%") 名称
                                                        th(style="width: 30%") 容器内路径
                                                        th(style="width: 40%") 配置文件
                                                tbody
                                                    tr(ng-repeat="volumeMountConfig in containerDraft.configConsoles")
                                                        td(ng-bind="volumeMountConfig.name")
                                                        td(ng-bind="volumeMountConfig.containerPath")
                                                        td
                                                            div(ng-if="!volumeMountConfig.volumeConfigMap.iterms") 默认设置
                                                            div(ng-repeat="(key, value) in volumeMountConfig.volumeConfigMap.iterms")
                                                                | {{ key }}：{{ value || '未设置' }}
                                form-config-item(config-title="启动命令")
                                    form-input-container
                                        .line-long(ng-if="!containerDraft.commands") 未设置
                                        .line-long(ng-if="containerDraft.commands")
                                             span(ng-bind='containerDraft.commands')
                                form-config-item(config-title="启动参数")
                                    form-input-container
                                        .line-long(ng-if="!containerDraft.args") 未设置
                                    form-input-container(ng-repeat='argsList in containerDraft.args')
                                        .line-long(ng-if="containerDraft.args && containerDraft.args.length > 0")
                                             span(ng-bind='argsList')
                                form-config-item(config-title="运行过程环境变量")
                                    form-input-container
                                        .line-long
                                            span(ng-if="!containerDraft.newEnv||containerDraft.newEnv.length===0") 未设置
                                            table.ui-table-primary.full(ng-hide="!containerDraft.newEnv||containerDraft.newEnv.length===0")
                                                thead
                                                    tr
                                                        th(style="width: 30%") 环境变量名
                                                        th(style="width: 30%") 环境变量值
                                                        th(style="width: 40%") 描述
                                                tbody
                                                    tr(ng-repeat="env in containerDraft.newEnv")
                                                        td(ng-bind="env.key")
                                                        td(ng-bind="env.value")
                                                        td(ng-cloak) {{env.description||'无'}}
                                form-config-item(config-title="容器大小")
                                    form-input-container
                                        span(style="margin-right: 30px;") CPU：{{containerDraft.cpu}}个
                                        span 内存：{{containerDraft.mem}}MB
                                form-config-item(config-title="镜像拉取策略")
                                    form-input-container
                                        span(ng-bind="({'Always': 'Always', 'Never': 'Never', 'IfNotPresent': 'If Not Present'}[containerDraft.imagePullPolicy])")
                                form-config-item(config-title="健康检查")
                                    form-input-container
                                        span(ng-bind="({'NONE': 'None', 'HTTP': 'HTTP检查', 'TCP': 'TCP检查'}[containerDraft.healthChecker.type])")
                                        div(ng-if="containerDraft.healthChecker.type=='TCP'||containerDraft.healthChecker.type=='HTTP'")
                                            span 检查端口:
                                            span.tool-next(ng-bind="containerDraft.healthChecker.port")
                                        div(ng-if="containerDraft.healthChecker.type=='TCP'||containerDraft.healthChecker.type=='HTTP'")
                                            span 超时时间（s）：
                                            span.tool-next(ng-cloak) {{containerDraft.healthChecker.timeout}}
                                        div(ng-if="containerDraft.healthChecker.type=='TCP'||containerDraft.healthChecker.type=='HTTP'")
                                            span 首次检测延迟（s）：
                                            span.tool-next(ng-cloak) {{containerDraft.healthChecker.delay}}
                                        div(ng-if="containerDraft.healthChecker.type=='TCP'||containerDraft.healthChecker.type=='HTTP'")
                                            span 检查周期（s）：
                                            span.tool-next(ng-cloak) {{containerDraft.healthChecker.periodSeconds}}
                                        div(ng-if="containerDraft.healthChecker.type=='TCP'||containerDraft.healthChecker.type=='HTTP'")
                                            span 失败次数：
                                            span.tool-next(ng-cloak) {{containerDraft.healthChecker.failureThreshold}}
                                        div(ng-if="containerDraft.healthChecker.type=='TCP'||containerDraft.healthChecker.type=='HTTP'")
                                            span 成功次数：
                                            span.tool-next(ng-cloak) {{containerDraft.healthChecker.successThreshold}}
                                        div(ng-if="containerDraft.healthChecker.type=='HTTP'")
                                            span 检测URL：
                                            span.tool-next(ng-bind="containerDraft.healthChecker.url")
                                        div(ng-if="containerDraft.healthChecker.type=='HTTP'")
                                            span 允许返回值：
                                            span.tool-next 200-400(不包含400)
                                form-config-item(config-title="就绪性检查")
                                    form-input-container
                                        .line-long(ng-if="!containerDraft.readinessChecker") 未设置
                                        span(ng-bind="({'NONE': 'None', 'HTTP': 'HTTP检查', 'TCP': 'TCP检查'}[containerDraft.readinessChecker.type])")
                                        div(ng-if="containerDraft.readinessChecker.type=='TCP'||containerDraft.readinessChecker.type=='HTTP'")
                                            span 检查端口:
                                            span.tool-next(ng-bind="containerDraft.readinessChecker.port")
                                        div(ng-if="containerDraft.readinessChecker.type=='TCP'||containerDraft.readinessChecker.type=='HTTP'")
                                            span 超时时间（s）：
                                            span.tool-next(ng-cloak) {{containerDraft.readinessChecker.timeout}}
                                        div(ng-if="containerDraft.readinessChecker.type=='TCP'||containerDraft.readinessChecker.type=='HTTP'")
                                            span 首次检测延迟（s）：
                                            span.tool-next(ng-cloak) {{containerDraft.readinessChecker.delay}}
                                        div(ng-if="containerDraft.readinessChecker.type=='TCP'||containerDraft.readinessChecker.type=='HTTP'")
                                            span 检查周期（s）：
                                            span.tool-next(ng-cloak) {{containerDraft.readinessChecker.periodSeconds}}
                                        div(ng-if="containerDraft.readinessChecker.type=='TCP'||containerDraft.readinessChecker.type=='HTTP'")
                                            span 失败次数：
                                            span.tool-next(ng-cloak) {{containerDraft.readinessChecker.failureThreshold}}
                                        div(ng-if="containerDraft.readinessChecker.type=='TCP'||containerDraft.readinessChecker.type=='HTTP'")
                                            span 成功次数：
                                            span.tool-next(ng-cloak) {{containerDraft.readinessChecker.successThreshold}}
                                        div(ng-if="containerDraft.readinessChecker.type=='HTTP'")
                                            span 检测URL：
                                            span.tool-next(ng-bind="containerDraft.readinessChecker.url")
                                        div(ng-if="containerDraft.readinessChecker.type=='HTTP'")
                                            span 允许返回值：
                                            span.tool-next 200-400(不包含400)
                                form-config-item(config-title="日志")
                                    form-input-container
                                        span.first-info(ng-if="!containerDraft.logItemDrafts || containerDraft.logItemDrafts.length===0") 未设置
                                        ul.log-info.first-info(ng-cloak)
                                            li(ng-repeat="logDraft in containerDraft.logItemDrafts")
                                                div.log-path 日志路径：{{logDraft.logPath}}
                                                div 自动收集日志：{{logDraft.autoCollect?'开启':'未开启'}}
                                                div(ng-if="logDraft.autoCollect")
                                                    div 日志Topic：{{logDraft.logTopic}}
                                                    div 预处理命令：{{logDraft.processCmd||'未设置'}}
                                                        a.icon-help(style="margin-left:10px;" popover="对收集到的日志做进一步处理，比如筛选或增减字段等，可以用grep和awk命令完成，命令以管道形式执行，因此必须以“|”开始，比如一个典型的处理命令为：   | grep \"ERROR\\\\|WARN\\\\| EXCEPTION\\\\| statistic\" | awk -vnhost=\"$HOSTNAME\" '{print \"[\"nhost\"]--\"$0}'，该命令将只筛选包含四个对应关键字的行，并且会在行首添加\"[hostname]--\"的字符串，参照可完成其他复杂的处理方式")
                                                div 自动删除日志：{{logDraft.autoDelete?'开启':'未开启'}}
                                                div(ng-if="logDraft.autoDelete") 过期时间：{{logDraft.logExpired}}小时
                h4.mod-title 部署设置
                .com-list-info.mirror-con
                    form
                        form-container
                            form-config-group
                                form-config-item(ng-if="config.stateful" config-title="网络模式")
                                    form-input-container
                                        span(ng-bind="({'HOST': 'Host', 'DEFAULT': '默认'}[config.networkMode])")
                                form-config-item(config-title="部署类型")
                                    form-input-container
                                        span(ng-bind="config.deployTypeShow")
                                form-config-item(config-title="筛选主机")
                                    form-input-container
                                        div(ng-cloak)
                                            span(style="margin-right: 30px;") 集群：{{deployVersionDraft.clusterName}}
                                            span(style="margin-right: 30px;") namespace：{{config.namespace}}
                                            span 工作场景：{{({'TEST': '测试环境', 'PROD': '生产环境'}[deployVersionDraft.hostEnv])}}
                                        .line-long(ng-if="config.stateful")
                                            span.tool-align-input 所选主机：
                                            .host-txt-con.line-element.com-select-con(select-con)
                                                ul.selected-labels
                                                    li.select-label(ng-repeat="host in config.hostList" ng-bind="host")
                                        .line-long(ng-if="!config.stateful && (config.versionType || 'CUSTOM') === 'CUSTOM'")
                                            span 主机标签：
                                            .host-txt-con.line-element.com-select-con(select-con)
                                                ul.selected-labels
                                                    li(ng-if="!deployVersionDraft.labelSelectors || deployVersionDraft.labelSelectors.length ===0") 无
                                                    li.select-label(style="height: auto;" ng-repeat="label in deployVersionDraft.labelSelectors" ng-cloak)
                                                        | {{label.name}}
                                            span.txt-wrap
                                                a.link-safe(ng-click="showHostByLabels()") 查看选中主机
                                form-config-item(ng-if="(config.versionType || 'CUSTOM') === 'CUSTOM'" config-title="网络模式")
                                    form-input-container
                                        span(ng-bind="config.networkMode=='HOST'?'Host':'Overlay'")
                                form-config-item(config-title="部署描述")
                                    form-input-container
                                        .line-long
                                            div(style="display: inline-block;")
                                                span(ng-if="!isEditDesc" ng-bind="config.description || '无描述信息'")
                                                textarea.ui-input-fill(ng-if="isEditDesc" ng-model="editDescription.text" style="width: 450px; resize: vertical;")
                                            div(ng-if="mayUpdate" style="margin-left: 10px; display: inline-block;")
                                                .fa.fa-pencil.icon-edit-color(ng-if="!isEditDesc" ng-click="toggleIsEditDesc()" tooltip="修改" style="padding:0 5px !important; cursor: pointer;" )
                                                .fa.fa-floppy-o.icon-success-color(ng-if="isEditDesc" ng-click="saveDescription()" tooltip="保存" style="padding:0 5px !important; cursor: pointer;" )
                                                .fa.fa-times.icon-cancel-color(ng-if="isEditDesc" ng-click="toggleIsEditDesc()" tooltip="取消" style="padding:0 5px !important; cursor: pointer;" )
                                form-config-item(config-title="YAML配置" ng-if="config.versionType === 'YAML'")
                                    form-input-container
                                        .info-content.code-area(style="line-height: 20px;" ng-bind="deployVersionDraft.versionString.deploymentStr")
                                form-config-item(config-titel="JSON配置" ng-if="config.versionType === 'JSON'")
                                    form-input-container
                                        .info-content.code-area(style="line-height: 20px;" ng-bind="deployVersionDraft.versionString.deploymentStr")
        tab(heading="升级" active="tabActive[1].active" ng-if="!config.stateful" ui-sref="deployDetail.update")
            .deploy-info(ng-form role="form" name="deployForm" ng-class="{'need-valid':valid.needValid}")
                update-deployment-detail(cluster-id="config.clusterId" cluster-log="config.clusterLog" namespace="config.namespace" deployment-id="config.deployId" version-id="currentVersionId" version-type="config.versionType" deployment-status="config.deploymentStatus" default-replicas="config.defaultReplicas" on-update-success="updateSuccess()" has-update-permission="mayUpdate")
        tab(heading="事件" active="tabActive[2].active" ng-click="getEvents()" ui-sref="deployDetail.event")
            .events-con
                ul.events-list
                    li.event-success(ng-if="eventList.length===0") 无事件信息
                    li(ng-repeat="event in eventList" ng-class="{'START':'event-building','PROCESSING':'event-building','SUCCESS':'event-success','FAILED':'event-failed','KUBERNETES':'event-system','ABORTED':'event-system','null':'event-system','undefined':'event-system'}[event.eventStatus]")
                        span.icon-dot
                            i.dot-line
                        span.event-name(ng-bind="event.operation | eventOperation")
                        span.event-result(ng-bind="event.eventStatus | eventStatus")
                        span.event-date(ng-bind="(event.startTime | time)")
                        span.event-author(ng-cloak)
                            i.icon-user(tooltip="操作者")
                            | {{event.userName}}
                        span.event-process(ng-if="event.operation!='KUBERNETES'")
                            span.event-process-item(tooltip="起始状态" tooltip-placement="left")
                                i.icon-process-dot.start
                                div.event-process-detail
                                    span.sig-event-process(ng-bind="'无状态'+' , '+'0实例'" ng-if="!event.primarySnapshot.length")
                                    span.sig-event-process(ng-repeat="status in event.primarySnapshot" ng-bind="'version'+status.version+' , '+status.replicas+'实例'")
                            span.event-process-item(tooltip="目标状态" tooltip-placement="left")
                                i.icon-process-dot.origin
                                div.event-process-detail
                                    span.sig-event-process(ng-bind="'无状态'+' , '+'0实例'" ng-if="!event.targetSnapshot.length")
                                    span.sig-event-process(ng-repeat="status in event.targetSnapshot" ng-bind="'version'+status.version+' , '+status.replicas+'实例'")
                            span.event-process-item(tooltip="完成状态" tooltip-placement="left")
                                i.icon-process-dot.current
                                div.event-process-detail
                                    span.sig-event-process(ng-bind="'无状态'+' , '+'0实例'" ng-if="!event.currentSnapshot.length")
                                    span.sig-event-process(ng-repeat="status in event.currentSnapshot" ng-bind="'version'+status.version+' , '+status.replicas+'实例'")
                        span.event-process.tool-nowrap(ng-if="event.operation=='KUBERNETES'" ng-bind="event.message" hoverable-popover content="event.message")
                        span.txt-warning.event-info(ng-show="event.eventStatus=='FAILED'"  tooltip="点击打开/关闭" tooltip-placement="left" style="position:relative;user-select:none;" ng-click="showWrong(event.eid)") 错误信息
                            .popover.top.toggle(ng-show="event.eventStatus=='FAILED' && wrongMessageList[event.eid]" ng-class="animation")
                                .arrow
                                .popover-inner
                                    .popover-content(ng-bind="event.message")
        tab(heading="实例" active="tabActive[3].active" ui-sref="deployDetail.instance")
            .instance-con
                table.ui-table-Lunar.instance-list
                    thead
                        tr
                            th 实例名称
                            th 所在主机
                            th 部署版本
                            th 启动时间
                            th 实例状态
                            th 日志
                            th 容器控制台
                            th(ng-if='mayUpdate') 操作
                    tbody
                        tr(ng-if="!instanceList || instanceList.length===0")
                            td(colspan="8") 无实例信息
                        tr(ng-repeat="ins in instanceList")
                            td(ng-bind="ins.instanceName")
                            td(ng-if='!ins.hostIp || ins.hostIp.length===0') 无
                            td(ng-if='ins.hostIp') {{ins.hostIp}}
                            td(ng-cloak) version{{ins.versionId}}
                            td(ng-bind="(ins.startTime | time)")
                            td(ng-bind="ins.status")
                            td
                                a.link-safe(ng-click="showLog(ins.instanceName,ins.containers)") 查看
                            td
                                a.link-safe(ng-click="toConsole($index)") 进入
                            td(ng-if="mayUpdate && ins.status !== 'Pending' && ins.status !== 'Terminating' && ins.status !== 'ContainerCreating'")
                                a.link-safe(ng-click="restart(ins.instanceName)") 重启
                            td(ng-if="mayUpdate && ins.status === 'Pending' || ins.status === 'Terminating' || ins.status === 'ContainerCreating'")
                                a.link-safe(style='color:#afafaf;cursor:default;pointer-events:none;') 重启
        //- tab(heading="健康检查" active="tabActive[4].active" ui-sref="deployDetail.healthcheck")
            .health-con
                ul.com-list-info
                    li
                        span.info-name.not-align-input 健康检查
                        .info-content(ng-switch="config.healthCheckerDraft.type")
                            span(ng-switch-default) None
                            span(ng-switch-when="HTTP") Http检查
                            span(ng-switch-when="TCP") Tcp检查
                            .line-long(ng-if="config.healthCheckerDraft.type=='TCP'||config.healthCheckerDraft.type=='HTTP'")
                                span.child-name 检查端口
                                span.child-txt(ng-bind="config.healthCheckerDraft.port")
                            .line-long(ng-if="config.healthCheckerDraft.type=='TCP'||config.healthCheckerDraft.type=='HTTP'")
                                span.child-name 超时时间（s）
                                span.child-txt(ng-cloak) {{config.healthCheckerDraft.timeout}}
                            .line-long(ng-if="config.healthCheckerDraft.type=='HTTP'")
                                span.child-name 检测URL
                                span.child-txt(ng-bind="config.healthCheckerDraft.url")
                            .line-long(ng-if="config.healthCheckerDraft.type=='HTTP'")
                                span.child-name 允许返回值
                                span.child-txt  200-400(不包含400)
        tab(heading="网络/访问" active="tabActive[4].active" ui-sref="deployDetail.network")
            .health-con.deploy-info
                .txt-prompt(style="padding-top: 20px;")
                    i.fa.fa-info-circle &nbsp;
                    span 创建部署时LunarOS会根据用户提供的程序访问端口创建一个对内服务，如果用户想对外暴露服务，可以到
                    a.txt-bright(ui-sref="loadBalanceCollection") 负载均衡
                    span 模块创建kube_proxy类型的对外服务(支持四层TCP/UDP)或者nginx类型的对外服务（支持七层HTTP）
                form-container
                    form(name="networkFrom" ng-class="{'need-valid':networkFrom.$submitted}")
                        loading(ng-if="isUpdatingLoadBalance || isgetingLoadBalance")
                        form-config-group
                            form-config-item(config-title="网络模式")
                                form-input-container
                                    span.small-info(ng-bind="showDeployNet.networkMode === 'HOST'?'Host':'Overlay'")
                        form-config-group
                            form-config-item(config-title="访问设置")
                                form-input-container
                                    div(ng-if="showDeployNet.networkMode === 'DEFAULT'")
                                        div.container-operation(ng-if="!showDeployNet.lbForDeploys")
                                            div.operation-button
                                                icon-edit(ng-if="!isEditLoadBalance" ng-click="toggleEditLoadBalance('edit')")
                                                icon-save(ng-if="isEditLoadBalance" ng-click="updateLoadBalance()")
                                                icon-cancel(ng-if="isEditLoadBalance" ng-click="toggleEditLoadBalance('cancel')")
                                            div.operation-content(ng-if="!isEditLoadBalance")
                                                div 服务类型：对内服务
                                                div 内网域名：未设置
                                                div 粘性会话：未设置
                                                div 程序服务端口：未设置
                                            div.operation-content(ng-if="isEditLoadBalance")
                                                div 服务类型：对内服务
                                                div 内网域名：未设置
                                                .content-name 粘性会话
                                                .content-item
                                                    form-input-radio-group(ng-model="innerServiceUpdateDraft.sessionAffinity" fallback-value="'false'" name="sessionAffinity" options="[{value: 'false', text: '关闭(默认)'}, {value: 'true', text: '开启'}]"  required)
                                                .content-name 程序服务端口
                                                .content-item
                                                    form-array-container(ng-model="innerServiceUpdateDraft.loadBalancerPorts" name="innerService" template="_innerService" max-length="1000" min-length="1" type="simple")
                                                    script(type="text/ng-template" id="_innerService")
                                                        input(type="number" style="width: 100%;" min="1" max="65535" placeholder="容器内程序服务端口" ng-model="$ctrl.ngModel[$index].targetPort" required)
                                        div.container-operation(ng-repeat="loadBalance in showDeployNet.lbForDeploys")
                                            div.operation-button(ng-if="loadBalance.lbType === 'INNER_SERVICE'")
                                                icon-edit(ng-if="!isEditLoadBalance" ng-click="toggleEditLoadBalance('edit')")
                                                icon-save(ng-if="isEditLoadBalance" ng-click="updateLoadBalance()")
                                                icon-cancel(ng-if="isEditLoadBalance" ng-click="toggleEditLoadBalance('cancel')")
                                            div.operation-content(ng-if="loadBalance.lbType === 'INNER_SERVICE'")
                                                div 服务类型：对内服务
                                                div
                                                    span 内网域名：
                                                    span(ng-bind="loadBalance.dnsName")
                                                div(ng-if="!isEditLoadBalance")
                                                    span 粘性会话：
                                                    span(ng-bind="({true: '已开启', 'false': '已关闭'}[loadBalance.serviceDraft.sessionAffinity]) || '未设置'")
                                                div(ng-if="!isEditLoadBalance")
                                                    span 程序服务端口：
                                                    span(ng-if="!loadBalance.serviceDraft || !loadBalance.serviceDraft.lbPorts || loadBalance.serviceDraft.lbPorts.length === 0") 未设置
                                                    span(ng-repeat="port in loadBalance.serviceDraft.lbPorts")
                                                        span(style="margin-right: 20px;" ng-bind="port.targetPort")
                                            div.operation-content(ng-if="isEditLoadBalance && loadBalance.lbType === 'INNER_SERVICE'")
                                                .content-name 粘性会话
                                                .content-item
                                                    form-input-radio-group(ng-model="innerServiceUpdateDraft.sessionAffinity" fallback-value="'false'" name="sessionAffinity" options="[{value: 'false', text: '关闭(默认)'}, {value: 'true', text: '开启'}]"  required)
                                                .content-name 程序服务端口
                                                .content-item
                                                    form-array-container(ng-model="innerServiceUpdateDraft.loadBalancerPorts" name="innerService" template="_updateInnerService" max-length="1000" min-length="1" type="simple")
                                                script(type="text/ng-template" id="_updateInnerService")
                                                    input(type="number" style="width: 100%;" min="1" max="65535" placeholder="容器内程序服务端口" ng-model="$ctrl.ngModel[$index].targetPort" required)
                                            div.operation-content(ng-if="loadBalance.lbType === 'EXTERNAL_SERVICE'")
                                                div 服务类型：kube_proxy对外服务
                                                    a.txt-bright(style="margin-left: 20px;" ui-sref="kubeLoadBalanceDetail({'collectionId': loadBalance.lbcId, 'loadBalanceId': loadBalance.lbId})") 查看详情
                                                div
                                                    span 内网域名：
                                                    span(ng-bind="loadBalance.dnsName")
                                                div
                                                    span 对外访问IP：
                                                    span(ng-repeat=" ip in loadBalance.externalIPs")
                                                        span(style="margin-right: 20px;" ng-bind="ip")
                                                div
                                                    span 粘性会话：
                                                    span(ng-bind="({true: '已开启', 'false': '已关闭'}[loadBalance.serviceDraft.sessionAffinity])")
                                                table.full
                                                    thead
                                                        tr
                                                            td 访问端口
                                                            td 程序服务端口
                                                            td 端口协议
                                                    tbody
                                                        tr(ng-if="!loadBalance.serviceDraft.lbPorts||loadBalance.serviceDraft.lbPorts.length===0")
                                                            td(colspan="3") 无相关信息
                                                        tr(ng-repeat="lbPort in loadBalance.serviceDraft.lbPorts")
                                                            td(ng-bind="lbPort.port")
                                                            td(ng-bind="lbPort.targetPort")
                                                            td(ng-bind="lbPort.protocol")
                                            div.operation-content(ng-if="loadBalance.lbType === 'NGINX'")
                                                div 服务类型：nginx服务
                                                    a.txt-bright(style="margin-left: 20px;" ui-sref="nginxLoadBalanceDetail({'collectionId': loadBalance.lbcId, 'loadBalanceId': loadBalance.lbId})") 查看详情
                                                div
                                                    span 服务域名：
                                                    span(ng-repeat="rule in loadBalance.nginxDraft.rules")
                                                        span(style="margin-right: 20px;" ng-bind="rule.domain")
                                                div
                                                    span 服务端口：
                                                    span(ng-bind="loadBalance.nginxDraft.listenPort")
                                                div
                                                    span 负载均衡策略：
                                                    span(ng-bind="loadBalance.nginxDraft.lbMethod | lowercase")
                                    div(ng-if="showDeployNet.networkMode === 'HOST'")
                                        div(ng-bind="showDeployNet.exposePortNum !== 0 ? '允许访问': '禁止访问'")
                                        div.log-item-none-top.log-item.log-item-align(ng-if="showDeployNet.exposePortNum !== 0")
                                            .line-full
                                                span 对外暴露端口个数：
                                                strong(ng-bind="showDeployNet.exposePortNum")
                                            .txt-prompt(style="line-height: 25px;") Host网络下，系统会给每个实例分配若干个端口，用于对外服务和实例间通信。此外，在Host网络下，实例ip和宿主机ip一致。
                        //form-config-group
                        //    form-config-item(config-title="内网域名")
                        //        form-input-container
                        //            span(ng-bind="showDeployNet.serviceDnsName")
