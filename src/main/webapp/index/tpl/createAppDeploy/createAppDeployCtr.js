"use strict";!function(e,t){void 0!==e&&e.controller("CreateAppDeployCtr",["$scope","$LunarAppStore","$LunarCluster","$LunarUser","$state","$stateParams","dialog",function(e,t,o,a,n,p,r){p.appName||n.go("appStore"),e.$emit("pageTitle",{title:p.appName,descrition:"",mod:"appStore"});var l=void 0,s=o.getInstance("NodeService");t.getStoreApps().then(function(o){var a=!1;if(o.data){for(var i=0,d=o.data.length;i<d;i++)if(o.data[i].appName===p.appName){a=!0,l=o.data[i];break}if(a){var g={logItemDrafts:[]},f=l.deploymentTemplate.logPathList;f||(f=[]);for(var m=0,c=f.length;m<c;m++)g.logItemDrafts.push({logPath:f[m],autoCollect:!1,autoDelete:!1});l.deploymentTemplate.logPathList=void 0,l.deploymentTemplate.logDraft=g,l.deploymentTemplate.networkMode="DEFAULT",e.appInfoIns=t.getInstance("AppInfo",l),e.config=e.appInfoIns.config,e.deployIns=e.appInfoIns.deployIns,e.deployConfig=e.deployIns.config,s.getData().then(function(t){e.deployIns.clusterListIns.init(t.data.result),e.deployIns.toggleCluster()})}else r.error("警告","无相关应用数据"),n.go("appStore")}else r.error("警告","请求失败！"),n.go("appStore")},function(){r.error("警告","请求失败！"),n.go("appStore")}),e.createDeploy=function(){e.isLoading=!0,e.deployIns.create().then(function(){r.alert("提示","创建成功！"),n.go("deployManage")},function(e){"namespace"==e.type?r.error("创建名空间失败",e.msg):r.error("创建失败",e.msg)}).finally(function(){e.isLoading=!1})}}])}(angular.module("LunarApp"));